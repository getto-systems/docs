---
title: UI層と gRPC で通信する
date: GETTO_DOCS_CONTENT_DATE
description: >
  ブラウザとドメインサービスの通信に gRPC を使用する
---

## 目的

ドメインの知識がアプリケーション層に染み出すのを防ぐため、UI層との通信に gRPC を使用する。

- アプリケーション層として別途、gRPC を使用した通信モジュールを開発することで、ドメイン層を遠ざける
- UI層から通信の責務をなくすことで、UI層にアプリケーションの知識が染み出すのを防ぐ
- gRPC という目立つ要素を取り入れることで、アプリケーション層以外に gRPC の構造が使われていないか確認する


## 試したこと

- ブラウザと gRPC した
  - [grpc-web](https://github.com/grpc/grpc-web) でブラウザと gRPC できた
  - [Envoy](https://www.envoyproxy.io/) をリバースプロキシとして使用
  - 飛んでいるリクエストは xhr のようなので、Fastly で問題なくいけるはず
- Envoy で JWT を吐き出すことはできない
  - JWT の検証、Role Based 認可はできそう
- WebAuthn のデモサイトで Edge, Firefox による指紋認証を確認
  - Chrome でもできるはず


## あとでやること（たぶんできる）

- 認証認可のしくみを考える
  - go で WebAuthn サーバー構築
    - WebAuthn による認証
    - JWT の出力
  - Envoy で認証、認可


## 指標

- アプリケーション層が交換可能になっているか
  - gRPC の構造が UI層、ドメイン層に漏れ出していないか
  - 認証認可のしくみが UI層、ドメイン層に漏れ出していないか


## 検証

追記日時 : 2020-01-20（検証中）


## 課題

- gRPC をほかの通信技術と交換できる構造にしたい
